{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import'../styles/project-members.css';import{authFetch}from'../utils/authFetch';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProjectMembers(){const{id}=useParams();const[members,setMembers]=useState([]);const[email,setEmail]=useState('');const[messages,setMessages]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[currentUserId,setCurrentUserId]=useState(null);const[ownerId,setOwnerId]=useState(null);useEffect(()=>{const fetchMembers=async()=>{try{const response=await authFetch(`/api/projects/${id}/members/`,{method:'GET'});if(response.status===401){window.location.href='/login';return;}if(!response.ok){throw new Error('Failed to fetch members');}const data=await response.json();setMembers(data.members);setCurrentUserId(data.current_user_id);setOwnerId(data.owner_id);}catch(err){console.error('Error fetching members:',err);setError('Something went wrong. Please try again later.');}finally{setLoading(false);}};fetchMembers();},[id]);const handleInvite=async e=>{e.preventDefault();setLoading(true);setError(null);try{const response=await authFetch(`/api/projects/${id}/members/invite/`,{method:'POST',body:JSON.stringify({email})});const data=await response.json();if(response.ok){setMessages([{text:data.detail||`Invite sent to ${email}`,type:'success'}]);setEmail('');}else{setMessages([{text:data.detail||'Failed to send invite',type:'error'}]);}}catch(err){console.error('Error inviting member:',err);setError('Something went wrong. Please try again later.');}finally{setLoading(false);}};const removeMember=async memberId=>{try{const response=await authFetch(`/api/projects/${id}/members/${memberId}/`,{method:'DELETE'});if(response.ok){setMembers(members.filter(m=>m.id!==memberId));}else{const data=await response.json();setMessages([{text:data.detail||'Failed to remove member',type:'error'}]);}}catch(err){console.error('Error removing member:',err);setError('Something went wrong. Please try again later.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"dashboard__title\",children:\"Project Members\"}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"dashboard__error\",children:error}),messages.length>0&&/*#__PURE__*/_jsx(\"ul\",{className:\"messages\",children:messages.map((msg,index)=>/*#__PURE__*/_jsx(\"li\",{className:`message ${msg.type}`,children:msg.text},index))}),/*#__PURE__*/_jsx(\"div\",{className:\"member-list\",children:members.length>0?members.map(m=>{const isSelf=m.id===currentUserId;const isOwner=m.id===ownerId;const currentUserIsOwner=currentUserId===ownerId;return/*#__PURE__*/_jsxs(\"div\",{className:\"member\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"member__name\",children:[m.username,\" \",isOwner&&/*#__PURE__*/_jsx(\"span\",{title:\"Owner\",children:\"\\uD83D\\uDC51\"})]}),!isOwner&&(isSelf||currentUserIsOwner)&&/*#__PURE__*/_jsx(\"button\",{className:\"member__remove\",onClick:()=>removeMember(m.id),children:\"\\uD83D\\uDDD1\\uFE0F\"})]},m.id);}):/*#__PURE__*/_jsx(\"p\",{children:\"No members yet.\"})}),currentUserId===ownerId&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleInvite,className:\"invite-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),className:\"invite-form__input\",placeholder:\"Enter email to invite\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"invite-form__button\",children:\"Invite\"})]})]});}export default ProjectMembers;","map":{"version":3,"names":["React","useEffect","useState","useParams","authFetch","jsx","_jsx","jsxs","_jsxs","ProjectMembers","id","members","setMembers","email","setEmail","messages","setMessages","loading","setLoading","error","setError","currentUserId","setCurrentUserId","ownerId","setOwnerId","fetchMembers","response","method","status","window","location","href","ok","Error","data","json","current_user_id","owner_id","err","console","handleInvite","e","preventDefault","body","JSON","stringify","text","detail","type","removeMember","memberId","filter","m","className","children","length","map","msg","index","isSelf","isOwner","currentUserIsOwner","username","title","onClick","onSubmit","value","onChange","target","placeholder","required"],"sources":["C:/Users/Moldabek Jora/PycharmProjects/Web_back_project/webback_frontend/src/components/ProjectMembers.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport '../styles/project-members.css';\r\nimport { authFetch } from '../utils/authFetch';\r\n\r\nfunction ProjectMembers() {\r\n  const { id } = useParams();\r\n  const [members, setMembers] = useState([]);\r\n  const [email, setEmail] = useState('');\r\n  const [messages, setMessages] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [currentUserId, setCurrentUserId] = useState(null);\r\n  const [ownerId, setOwnerId] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchMembers = async () => {\r\n      try {\r\n        const response = await authFetch(`/api/projects/${id}/members/`, {\r\n          method: 'GET',\r\n        });\r\n\r\n        if (response.status === 401) {\r\n          window.location.href = '/login';\r\n          return;\r\n        }\r\n\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch members');\r\n        }\r\n\r\n        const data = await response.json();\r\n        setMembers(data.members);\r\n        setCurrentUserId(data.current_user_id);\r\n        setOwnerId(data.owner_id);\r\n      } catch (err) {\r\n        console.error('Error fetching members:', err);\r\n        setError('Something went wrong. Please try again later.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchMembers();\r\n  }, [id]);\r\n\r\n  const handleInvite = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await authFetch(`/api/projects/${id}/members/invite/`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ email }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        setMessages([{ text: data.detail || `Invite sent to ${email}`, type: 'success' }]);\r\n        setEmail('');\r\n      } else {\r\n        setMessages([{ text: data.detail || 'Failed to send invite', type: 'error' }]);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error inviting member:', err);\r\n      setError('Something went wrong. Please try again later.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const removeMember = async (memberId) => {\r\n    try {\r\n      const response = await authFetch(`/api/projects/${id}/members/${memberId}/`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (response.ok) {\r\n        setMembers(members.filter(m => m.id !== memberId));\r\n      } else {\r\n        const data = await response.json();\r\n        setMessages([{ text: data.detail || 'Failed to remove member', type: 'error' }]);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error removing member:', err);\r\n      setError('Something went wrong. Please try again later.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <h1 className=\"dashboard__title\">Project Members</h1>\r\n\r\n      {loading && <p>Loading...</p>}\r\n      {error && <p className=\"dashboard__error\">{error}</p>}\r\n\r\n      {messages.length > 0 && (\r\n        <ul className=\"messages\">\r\n          {messages.map((msg, index) => (\r\n            <li key={index} className={`message ${msg.type}`}>{msg.text}</li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n\r\n      <div className=\"member-list\">\r\n        {members.length > 0 ? (\r\n          members.map(m => {\r\n            const isSelf = m.id === currentUserId;\r\n            const isOwner = m.id === ownerId;\r\n            const currentUserIsOwner = currentUserId === ownerId;\r\n\r\n            return (\r\n              <div className=\"member\" key={m.id}>\r\n                <span className=\"member__name\">\r\n                  {m.username} {isOwner && <span title=\"Owner\">üëë</span>}\r\n                </span>\r\n\r\n                {(!isOwner && (isSelf || currentUserIsOwner)) && (\r\n                  <button className=\"member__remove\" onClick={() => removeMember(m.id)}>\r\n                    üóëÔ∏è\r\n                  </button>\r\n                )}\r\n              </div>\r\n            );\r\n          })\r\n        ) : (\r\n          <p>No members yet.</p>\r\n        )}\r\n      </div>\r\n\r\n      {currentUserId === ownerId && (\r\n          <form onSubmit={handleInvite} className=\"invite-form\">\r\n            <input\r\n              type=\"email\"\r\n              value={email}\r\n              onChange={e => setEmail(e.target.value)}\r\n              className=\"invite-form__input\"\r\n              placeholder=\"Enter email to invite\"\r\n              required\r\n            />\r\n            <button type=\"submit\" className=\"invite-form__button\">Invite</button>\r\n          </form>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProjectMembers;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}