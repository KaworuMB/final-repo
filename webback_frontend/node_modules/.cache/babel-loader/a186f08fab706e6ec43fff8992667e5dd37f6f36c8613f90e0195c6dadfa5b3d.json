{"ast":null,"code":"import React,{useState}from'react';import{useParams}from'react-router-dom';import{authFetch}from'../utils/authFetch';// JWT fetch\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function DocumentUpload(){const{id}=useParams();// project id\nconst[file,setFile]=useState(null);const[name,setName]=useState('');const handleSubmit=async e=>{e.preventDefault();if(!file)return;const formData=new FormData();formData.append('file',file);formData.append('name',name||file.name);formData.append('project',id);// 👈 обязательно\nconst response=await authFetch('/api/documents/',{method:'POST',body:formData// без headers\n});if(response.ok){alert(\"Документ загружен успешно\");window.location.href=`/projects/${id}`;// Перейти назад\n}else{alert(\"Ошибка загрузки\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"upload-form\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setFile(e.target.files[0]),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430 (\\u043E\\u043F\\u0446\\u0438\\u043E\\u043D\\u0430\\u043B\\u044C\\u043D\\u043E)\",value:name,onChange:e=>setName(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C\"})]})]});}export default DocumentUpload;","map":{"version":3,"names":["React","useState","useParams","authFetch","jsx","_jsx","jsxs","_jsxs","DocumentUpload","id","file","setFile","name","setName","handleSubmit","e","preventDefault","formData","FormData","append","response","method","body","ok","alert","window","location","href","className","children","onSubmit","encType","type","onChange","target","files","required","placeholder","value"],"sources":["C:/Users/Moldabek Jora/PycharmProjects/Web_back_project/webback_frontend/src/components/DocumentUpload.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { authFetch } from '../utils/authFetch'; // JWT fetch\r\n\r\nfunction DocumentUpload() {\r\n  const { id } = useParams(); // project id\r\n  const [file, setFile] = useState(null);\r\n  const [name, setName] = useState('');\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!file) return;\r\n\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('name', name || file.name);\r\n    formData.append('project', id); // 👈 обязательно\r\n\r\n    const response = await authFetch('/api/documents/', {\r\n      method: 'POST',\r\n      body: formData, // без headers\r\n    });\r\n\r\n    if (response.ok) {\r\n      alert(\"Документ загружен успешно\");\r\n      window.location.href = `/projects/${id}`; // Перейти назад\r\n    } else {\r\n      alert(\"Ошибка загрузки\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"upload-form\">\r\n      <h1>Загрузить документ</h1>\r\n      <form onSubmit={handleSubmit} encType=\"multipart/form-data\">\r\n        <input\r\n          type=\"file\"\r\n          onChange={e => setFile(e.target.files[0])}\r\n          required\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Название документа (опционально)\"\r\n          value={name}\r\n          onChange={e => setName(e.target.value)}\r\n        />\r\n        <button type=\"submit\">Загрузить</button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DocumentUpload;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,OAASC,SAAS,KAAQ,oBAAoB,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEhD,QAAS,CAAAC,cAAcA,CAAA,CAAG,CACxB,KAAM,CAAEC,EAAG,CAAC,CAAGP,SAAS,CAAC,CAAC,CAAE;AAC5B,KAAM,CAACQ,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACW,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAEpC,KAAM,CAAAa,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAChCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CAACN,IAAI,CAAE,OAEX,KAAM,CAAAO,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAET,IAAI,CAAC,CAC7BO,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEP,IAAI,EAAIF,IAAI,CAACE,IAAI,CAAC,CAC1CK,QAAQ,CAACE,MAAM,CAAC,SAAS,CAAEV,EAAE,CAAC,CAAE;AAEhC,KAAM,CAAAW,QAAQ,CAAG,KAAM,CAAAjB,SAAS,CAAC,iBAAiB,CAAE,CAClDkB,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEL,QAAU;AAClB,CAAC,CAAC,CAEF,GAAIG,QAAQ,CAACG,EAAE,CAAE,CACfC,KAAK,CAAC,2BAA2B,CAAC,CAClCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,aAAalB,EAAE,EAAE,CAAE;AAC5C,CAAC,IAAM,CACLe,KAAK,CAAC,iBAAiB,CAAC,CAC1B,CACF,CAAC,CAED,mBACEjB,KAAA,QAAKqB,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BxB,IAAA,OAAAwB,QAAA,CAAI,yGAAkB,CAAI,CAAC,cAC3BtB,KAAA,SAAMuB,QAAQ,CAAEhB,YAAa,CAACiB,OAAO,CAAC,qBAAqB,CAAAF,QAAA,eACzDxB,IAAA,UACE2B,IAAI,CAAC,MAAM,CACXC,QAAQ,CAAElB,CAAC,EAAIJ,OAAO,CAACI,CAAC,CAACmB,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAE,CAC1CC,QAAQ,MACT,CAAC,cACF/B,IAAA,UACE2B,IAAI,CAAC,MAAM,CACXK,WAAW,CAAC,8KAAkC,CAC9CC,KAAK,CAAE1B,IAAK,CACZqB,QAAQ,CAAElB,CAAC,EAAIF,OAAO,CAACE,CAAC,CAACmB,MAAM,CAACI,KAAK,CAAE,CACxC,CAAC,cACFjC,IAAA,WAAQ2B,IAAI,CAAC,QAAQ,CAAAH,QAAA,CAAC,wDAAS,CAAQ,CAAC,EACpC,CAAC,EACJ,CAAC,CAEV,CAEA,cAAe,CAAArB,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}