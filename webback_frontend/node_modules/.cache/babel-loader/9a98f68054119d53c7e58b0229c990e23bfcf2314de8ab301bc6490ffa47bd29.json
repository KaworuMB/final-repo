{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import{authFetch}from'../utils/authFetch';import'../styles/projects.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProjectDashboard=()=>{const[projects,setProjects]=useState([]);const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();useEffect(()=>{const accessToken=localStorage.getItem('access');if(!accessToken){navigate('/login');return;}const fetchUser=async()=>{try{const response=await authFetch('/api/auth/current_user/');if(response.status===401){navigate('/login');return;}if(!response.ok){throw new Error('Failed to fetch user');}const data=await response.json();setUser(data);}catch(err){console.error('Error fetching user:',err);}};const fetchProjects=async()=>{try{const response=await authFetch('/api/projects/');if(response.status===401){navigate('/login');return;}if(!response.ok){throw new Error('Failed to fetch projects');}const data=await response.json();setProjects(data);}catch(err){console.error('Error fetching projects:',err);setError('Something went wrong. Please try again later.');}finally{setLoading(false);}};fetchUser();fetchProjects();},[navigate]);const handleLogout=()=>{localStorage.removeItem('access');localStorage.removeItem('refresh');navigate('/login');};return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard__header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard__profile\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"dashboard__icon\",children:\"\\uD83D\\uDC64\"}),/*#__PURE__*/_jsx(\"span\",{className:\"dashboard__label\",children:user?user.username:'You'})]}),/*#__PURE__*/_jsx(\"button\",{className:\"dashboard__logout\",onClick:handleLogout,children:\"Logout\"})]}),/*#__PURE__*/_jsx(\"h1\",{className:\"dashboard__title\",children:\"Your Projects\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):error?/*#__PURE__*/_jsx(\"p\",{className:\"dashboard__error\",children:error}):projects.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"dashboard__projects\",children:projects.map(project=>/*#__PURE__*/_jsx(Link,{to:`/projects/${project.id}`,className:\"project-card\",children:project.project_name},project.id))}):/*#__PURE__*/_jsx(\"p\",{children:\"No projects found.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dashboard__add\",children:/*#__PURE__*/_jsx(Link,{to:\"/projects/create\",className:\"add-button\",children:\"+\"})})]});};export default ProjectDashboard;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","authFetch","jsx","_jsx","jsxs","_jsxs","ProjectDashboard","projects","setProjects","user","setUser","loading","setLoading","error","setError","navigate","accessToken","localStorage","getItem","fetchUser","response","status","ok","Error","data","json","err","console","fetchProjects","handleLogout","removeItem","className","children","username","onClick","length","map","project","to","id","project_name"],"sources":["C:/Users/Moldabek Jora/PycharmProjects/Web_back_project/webback_frontend/src/components/ProjectDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { authFetch } from '../utils/authFetch';\r\nimport '../styles/projects.css';\r\n\r\nconst ProjectDashboard = () => {\r\n  const [projects, setProjects] = useState([]);\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const accessToken = localStorage.getItem('access');\r\n    if (!accessToken) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    const fetchUser = async () => {\r\n      try {\r\n        const response = await authFetch('/api/auth/current_user/');\r\n        if (response.status === 401) {\r\n          navigate('/login');\r\n          return;\r\n        }\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch user');\r\n        }\r\n        const data = await response.json();\r\n        setUser(data);\r\n      } catch (err) {\r\n        console.error('Error fetching user:', err);\r\n      }\r\n    };\r\n\r\n    const fetchProjects = async () => {\r\n      try {\r\n        const response = await authFetch('/api/projects/');\r\n        if (response.status === 401) {\r\n          navigate('/login');\r\n          return;\r\n        }\r\n        if (!response.ok) {\r\n          throw new Error('Failed to fetch projects');\r\n        }\r\n        const data = await response.json();\r\n        setProjects(data);\r\n      } catch (err) {\r\n        console.error('Error fetching projects:', err);\r\n        setError('Something went wrong. Please try again later.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchUser();\r\n    fetchProjects();\r\n  }, [navigate]);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('access');\r\n    localStorage.removeItem('refresh');\r\n    navigate('/login');\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      <div className=\"dashboard__header\">\r\n        <div className=\"dashboard__profile\">\r\n          <span className=\"dashboard__icon\">ðŸ‘¤</span>\r\n          <span className=\"dashboard__label\">\r\n            {user ? user.username : 'You'}\r\n          </span>\r\n        </div>\r\n        <button className=\"dashboard__logout\" onClick={handleLogout}>Logout</button>\r\n      </div>\r\n\r\n      <h1 className=\"dashboard__title\">Your Projects</h1>\r\n\r\n      {loading ? (\r\n        <p>Loading...</p>\r\n      ) : error ? (\r\n        <p className=\"dashboard__error\">{error}</p>\r\n      ) : projects.length > 0 ? (\r\n        <div className=\"dashboard__projects\">\r\n          {projects.map(project => (\r\n            <Link to={`/projects/${project.id}`} key={project.id} className=\"project-card\">\r\n              {project.project_name}\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        <p>No projects found.</p>\r\n      )}\r\n\r\n      <div className=\"dashboard__add\">\r\n        <Link to=\"/projects/create\" className=\"add-button\">+</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProjectDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}